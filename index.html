<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Smart Notes</title>
<link href="https://fonts.googleapis.com/css2?family=Patrick+Hand&display=swap" rel="stylesheet">
<style>
:root {
  --bg-light: #f5f5f5;
  --bg-dark: #1e1e1e;
  --text-light: #000;
  --text-dark: #fff;
  --notepad-bg-light: #fff;
  --notepad-bg-dark: #2c2c2c;
  --canvas-bg-light: repeating-linear-gradient(white, white 24px, #e0e0e0 25px);
  --canvas-bg-dark: repeating-linear-gradient(#2c2c2c, #2c2c2c 24px, #444 25px);
  --navbar-light: #2b5797;
  --navbar-dark: #0d3c61;
}
body {
  margin:0;
  font-family:"Segoe UI",sans-serif;
  background: var(--bg-light);
  color: var(--text-light);
  transition: all 0.3s ease;
}
.navbar {
  display:flex;
  align-items:center;
  background: var(--navbar-light);
  color:white;
  padding:10px 20px;
  gap:10px;
  flex-wrap:wrap;
  position:sticky;
  top:0;
  z-index:10000;
  box-shadow:0 2px 5px rgba(0,0,0,0.2);
}
.navbar h2 { margin:0; font-size:20px; flex:1; }
.navbar button, .navbar select {
  border:none;
  background:#ffffff30;
  color:white;
  padding:5px 10px;
  border-radius:5px;
  cursor:pointer;
  transition: all 0.2s ease;
}
.navbar button:hover, .navbar select:hover { background:white; color:black; }
.container { display:flex; gap:15px; padding:20px; height:calc(100vh - 60px); box-sizing:border-box; }
#notepad {
  flex:3;
  min-height:100%;
  padding:20px;
  font-size:16px;
  line-height:1.6;
  border-radius:10px;
  box-shadow:0 0 5px rgba(0,0,0,0.2);
  overflow-y:auto;
  background: var(--notepad-bg-light);
  color: var(--text-light);
  transition: all 0.3s ease;
}
#canvas-container {
  flex:3;
  height:100%;
  overflow-y:auto;
  display:none;
  border-radius:10px;
  box-shadow:0 0 5px rgba(0,0,0,0.2);
  background:white;
  position:relative;
  transition: all 0.3s ease;
  z-index:1;
}
canvas {
  cursor:crosshair;
  background: var(--canvas-bg-light);
  display:block;
  border-radius:5px;
  margin-bottom:20px;
  z-index:1;
  position: relative;
}
#convertedText {
  font-family: 'Patrick Hand', cursive;
  font-size: 18px;
  white-space: pre-wrap;
  line-height: 1.6;
  padding: 20px;
  background: white;
  border-radius: 10px;
  box-shadow:0 0 5px rgba(0,0,0,0.2);
  max-height: 300px;
  overflow-y: auto;
  margin-top: 15px;
}
</style>
</head>
<body>

<div class="navbar">
<h2>Smart Notes</h2>
<button onclick="switchMode('typing')">Typing Mode</button>
<button onclick="switchMode('handwriting')">Handwriting Mode</button>
<select id="penColor" onchange="changePenColor()">
  <option value="#000000">Black</option>
  <option value="#FF0000">Red</option>
  <option value="#007BFF">Blue</option>
  <option value="#00B050">Green</option>
  <option value="#FFA500">Orange</option>
  <option value="#800080">Purple</option>
  <option value="#FFC0CB">Pink</option>
  <option value="#8B4513">Brown</option>
  <option value="#00FFFF">Cyan</option>
  <option value="#FFFF00">Yellow</option>
  <option value="#808080">Gray</option>
</select>
<button onclick="addPage()">‚ûï New Page</button>
<button onclick="exportPDF()">üìÑ Export PDF</button>
<button onclick="convertHandwriting()">‚úç Convert Handwriting</button>
<button onclick="copyConvertedText()">üìã Copy to Notepad</button>
<button onclick="toggleTheme()">üåô Dark/Light Mode</button>
</div>

<div class="container">
<div id="notepad" contenteditable="true"></div>
<div id="canvas-container"></div>
</div>

<div id="convertedText"></div>

<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/tesseract.js@4.0.2/dist/tesseract.min.js"></script>
<script>
const notepad = document.getElementById("notepad");
const canvasContainer = document.getElementById("canvas-container");
const convertedTextDiv = document.getElementById("convertedText");

let mode = "typing";
let penColor = "#000";
let pages = [];
let currentCanvas = null;
let ctx = null;
let darkMode = false;

function initCanvas(){
    const canvas = document.createElement("canvas");
    canvas.width = canvasContainer.clientWidth;
    canvas.height = 2000;
    canvas.style.background = darkMode ? "repeating-linear-gradient(#2c2c2c, #2c2c2c 24px, #444 25px)" : "repeating-linear-gradient(white, white 24px, #e0e0e0 25px)";
    canvasContainer.appendChild(canvas);
    pages.push(canvas);

    const context = canvas.getContext("2d");
    context.lineWidth = 2;
    context.lineCap = "round";
    context.strokeStyle = penColor;

    let drawing = false;
    canvas.onmousedown = e => { drawing=true; context.beginPath(); context.moveTo(e.offsetX, e.offsetY + canvasContainer.scrollTop); }
    canvas.onmouseup = () => drawing=false;
    canvas.onmousemove = e => { if(!drawing) return; context.lineTo(e.offsetX, e.offsetY + canvasContainer.scrollTop); context.stroke(); }

    currentCanvas = canvas;
    ctx = context;
}

function switchMode(selected){
    mode = selected;
    if(mode==="typing"){
        notepad.style.display="block";
        canvasContainer.style.display="none";
    } else {
        notepad.style.display="none";
        canvasContainer.style.display="block";
        if(pages.length===0) initCanvas();
    }
}

function changePenColor(){
    penColor = document.getElementById("penColor").value;
    if(ctx) ctx.strokeStyle = penColor;
}

function addPage(){ initCanvas(); }

function exportPDF(){
    const { jsPDF } = window.jspdf;
    const pdf = new jsPDF('p','pt','a4');
    if(mode==="typing"){
        const text = notepad.innerText;
        const lines = pdf.splitTextToSize(text,500);
        pdf.text(lines,40,40);
    } else {
        pages.forEach((canvasPage, i)=>{
            if(i>0) pdf.addPage();
            const img = canvasPage.toDataURL("image/png", 1.0);
            pdf.addImage(img,"PNG",0,0,595,842);
        });
    }
    pdf.save("SmartNotes.pdf");
}

function convertHandwriting(){
    if(!currentCanvas) return alert("Draw something first");
    convertedTextDiv.innerText = "Recognizing...";
    Tesseract.recognize(
        currentCanvas.toDataURL(),
        'eng',
        { logger: m => console.log(m) }
    ).then(({ data: { text } }) => {
        convertedTextDiv.innerText = text;
    });
}

function copyConvertedText(){
    notepad.innerText += convertedTextDiv.innerText + "\n";
}

function toggleTheme(){
    darkMode = !darkMode;
    document.body.style.background = darkMode ? "var(--bg-dark)" : "var(--bg-light)";
    document.body.style.color = darkMode ? "var(--text-dark)" : "var(--text-light)";
    document.querySelector(".navbar").style.background = darkMode ? "var(--navbar-dark)" : "var(--navbar-light)";
    notepad.style.background = darkMode ? "var(--notepad-bg-dark)" : "var(--notepad-bg-light)";
    notepad.style.color = darkMode ? "var(--text-dark)" : "var(--text-light)";
    pages.forEach(canvas => {
        canvas.style.background = darkMode ? "repeating-linear-gradient(#2c2c2c, #2c2c2c 24px, #444 25px)" : "repeating-linear-gradient(white, white 24px, #e0e0e0 25px)";
    });
}

// Start in typing mode
switchMode("typing");
</script>
</body>
</html>
